
# Reproducible analyses

The scripts in this directory reproduce the analyses of the curated datasets, in almost exactly the same order that they are mentioned in the article.

These scripts were written largely as a record of usage of the dashboard web application, which provides the same results.

You can run all the replication scripts in one go on the public demo API:

```sh
python run_all.py http://oncopathtk.org/api
```

Or, you can run them from your own local instance of the application, for example for a complete reproduction after installing all datasets into a local database:

```sh
python run_all.py "http://127.0.0.1:8080"
```

substituting if necessary the argument with the address of your local API server. (See *Setting up a local application instance*).

- These scripts just call the web API, and so they do not require Python package `spatialprofilingtoolbox`.
- You can alternatively store the API host in `api_host.txt` and omit the command-line argument above.
- The run result is here in [results.txt](results.txt).

## GNN importance fractions figure generation

This plot replication requires the installation of `spatialprofilingtoolbox`. It uses a command in the `spt graphs` CLI that uses the configuration files stored in `gnn_figure/` to reproduce the plots seen in our publication.

```bash
spt graphs plot-importance-fractions --config_path gnn_figure/melanoma_intralesional_il2.config --output_filename gnn_figure/melanoma_intralesional_il2.png
spt graphs plot-importance-fractions --config_path gnn_figure/urothelial_ici.config --output_filename gnn_figure/urothelial_ici.png
```

## Overview figure

An HTML figure representing all samples available in the database is generated by:

```bash
python create_overview_diagram.py
```

The figure is generated using `pystache` from template values (saved to `overview_diagram.json`) and template files:
- `overview_diagram.template.css`
- `overview_diagram.template.html`

So you could reproduce the figure from source data, or modified source data, using [Mustache](https://github.com/mustache/mustache/) directly.
