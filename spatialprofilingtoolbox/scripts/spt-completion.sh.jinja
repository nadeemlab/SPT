#!/bin/bash

_spt_completions()
{
    if [[ "${#COMP_WORDS[@]}" -eq "2" ]]; then
        COMPREPLY=($(compgen -W "{{ module_names }}" "${COMP_WORDS[1]}"));
    else
        if [[ "${#COMP_WORDS[@]}" -eq "3" ]]; then
            case ${COMP_WORDS[1]} in
{%- for module in modules %}
                {{ module.name }})
                    COMPREPLY=($(compgen -W "{{ module.command_names }}" "${COMP_WORDS[2]}"));
                ;;
{%- endfor %}
            esac
        fi
    fi
}

complete -F _spt_completions spt
